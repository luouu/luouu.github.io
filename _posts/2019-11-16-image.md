---
layout: post
title: 图像基础知识
categories: [image]
description: 
keywords: 
topmost: false
---

* TOC
{:toc}

## 像素

### RGB

在RGB 颜色空间上，当任何一个基色的亮度值为零时，即在原点处，就显示为黑色。当三种基色都达到最高亮度时，就表现为白色。在连接黑色与白色的对角线上，是亮度等量的三基色混合而成的灰色，该线称为灰色线。[详细](http://www.fourcc.org/rgb.php)

* RGB565格式每一个像素用16个bit来表示。 R, G, B分别用5， 6， 5个bit来表示。
* RGB55格式每一个像素用16个bit，但是最高位不用，R, G, B分别用5个bit来表示。
* RGB24每一个像素用24个bit来表示，R, G， B分量分别用8个bit来表示。
* RGB32每一个像素用32个bit表示，R, G, B分量分别用8个bit表示，存储顺序为B, G, R，最后8个字节保留。

```c
R = Y + 1.402 (Cr-128)
G = Y * 0.34414 (Cb-128) * 0.71414 (Cr-128)
B = Y + 1.772 (Cb-128)
```

### YUV

YUV是一种颜色编码方法，主要用于电视系统以及模拟视频领域，它将亮度信息（Y）与色彩信息（UV）分离，没有UV信息一样可以显示完整的图像（是不是写错了），只不过是黑白的，这样的设计很好地解决了彩色电视机与黑白电视的兼容问题。并且，YUV不像RGB那样要求三个独立的视频信号同时传输，YUV是数据总尺寸小于RGB格式（但用YUV444的话，和RGB888一样都是24bits），所以用YUV方式传送占用极少的频宽。

YUV，分为三个分量，“Y”表示明亮度（Luminance或Luma），也就是灰度值；而“U”和“V” 表示的则是色度（Chrominance或Chroma），作用是描述影像色彩及饱和度，用于指定像素的颜色。

![彩色，Y分量，V分量，U分量](/images/media/image/yuv.jpg)

YUV细分的话有Y'UV，YUV，YCbCr，YPbPr等类型，其中YCbCr主要用于数字信号。Y'CbCr也称为YUV，是YUV的压缩版本，不同之处在于Y'CbCr用于数字图像领域，YUV用于模拟信号领域，MPEG、DVD、摄像机中常说的YUV其实就是Y'CbCr。
其中，Cr反映了RGB输入信号红色部分与RGB信号亮度值之间的差异，而Cb反映的是RGB输入信号蓝色部分与RGB信号亮度值之间的差异，此即所谓的色差信号。[详细](http://www.fourcc.org/yuv.php)

```c
Y = 0.30R + 0.59G + 0.11B
U = 0.493(B-Y) = -0.15R - 0.29G + 0.44B
V = 0.877(R-Y) = 0.62R - 0.52G - 0.10B
```

#### 采样方式

YUV的采样有许多种，常用的有444，422，420，411等。用三个图来直观地表示采集的方式，以黑点表示采样该像素点的Y分量，以空心圆圈表示采用该像素点的UV分量。
![YUV常用采样](/images/media/image/yuv_sample.webp)

* 4:4:4采样，每一个Y对应一组UV分量，24 Bits per Pixel
* 4:2:2采样，每两个Y共用一组UV分量，16 Bits per Pixel
* 4:2:0采样，每四个Y共用一组UV分量，12 Bits per Pixel

#### 存储格式

对于packed的YUV格式，每个像素点的Y,U,V是连续交错存储的。

* UYVY422
![img](/images/media/image/UYVY422.webp)

* YUV420
![img](/images/media/image/YUV420.webp)

对于planar的YUV格式，先连续存储所有像素点的Y，紧接着存储所有像素点的U，随后是所有像素点的V。

* YUV422P
![img](/images/media/image/YUV422P.webp)

* YUV420P
![img](/images/media/image/YUV420P.webp)

对于SemiPlanar，则是先连续存储所有像素点的Y，再连续交错U和V。

* YUV422SP
![img](/images/media/image/YUV422SP.webp)

* YUV420SP
![img](/images/media/image/YUV420SP.webp)

### OSD字模

* 单色字模，1个像素对应1bit，1个8×8的字模对应的是8个字节的数据。
* 4色字模，1个像素对应2bit，1个8×8的字模对应的是8x2个字节的数据。
* 16色字模，1个像素对应4bit，1个8×8的字模对应的是8x4个字节的数据。

## 图像处理

在图像处理中，常见的颜色模型包括HSB（色相、饱和度、亮度）、RGB（红色、绿色、蓝色）、CMYK（青色、品红、黄色、黑色）和CIE L*a*b*等，因此，相应的颜色模式也就有RGB、CMYK、Lab等。在HSB颜色模型中，色相、饱和度、亮度是对图像属性的基本描述。

图象亮度（brightness）是指画面的明亮程度，单位是堪德拉每平米(cd/m2)或称nits。

对比度（contrast）指的是图像暗和亮的落差值，即图像最大灰度级和最小灰度级之间的差值。

饱和度（saturation）指的是图像颜色种类的多少， 上面提到图像的灰度级是[L~min~，L~max~]，则在L~min~、L~max~ 的中间值越多，便代表图像的颜色种类多，饱和度也就更高，外观上看起来图像会更鲜艳，调整饱和度可以修正过度曝光或者未充分曝光的图片，使图像看上去更加自然。

色相或者色调（hue）是从物体反射或透过物体传播的颜色。在0°到360°的标准色轮上，按位置度量色相。

锐度（sharpness）是图像清晰度和图像边缘锐利程度。图像锐化是补偿图像的轮廓，增强图像的边缘及灰度跳变的部分，使图像变得清晰。在做图像平滑，图像滤波处理的时候经过会把丢失图像的边缘信息，通过图像锐化便能够增强突出图像的边缘轮廓。

灰度是图像上每个像素的颜色值，指黑白图像中点的颜色深度，范围一般从0到255，白色为255，黑色为0。

* 最大值法：将彩色图像中的三分量亮度的最大值作为灰度图的灰度值，这种方法转换的灰度图亮度很高。

* 平均值法：将彩色图像中的三分量亮度求平均得到一个灰度值，这种方法产生的灰度图像比较柔和。

* 加权平均值法：以不同的权值对R，G，B的值加权平均，由于人眼对绿色最为敏感，对蓝色的敏感性最低，因此得到的灰度图像效果最好。$gray = 0.299*R + 0.578*G + 0.114*B$。

灰阶（gray scale）在YUV空间，将UV分量丢弃，只保留Y分量，得到的黑白图像。

复古（绿，蓝）（sepia / sepiagreen / sepiablue）就是在灰阶的基础上，对UV值额外再做了一个offset，将灰度图转换成某种颜色的梯度图。为了获得蓝色效果，应该增加蓝色差信号，减小红色差信号，即增大U，减小V。

负片（Negative Film）就是将图像的颜色反转，看起来就像是在看胶片底片时的效果。在RGB空间，取其补色，就是用255分别减去RGB得到新的RGB值。
![img](/images/media/image/complementary.jpg)
